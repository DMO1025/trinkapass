{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/app/actions/settings-actions.ts"],"sourcesContent":["'use server';\n\nimport { updateSettings, getSettings } from '@/lib/data-service.server';\nimport type { ActionResult, SettingsData } from '@/lib/types';\nimport { revalidatePath } from 'next/cache';\n\nexport async function updateMercadoPagoSettingsAction(accessToken: string): Promise<ActionResult> {\n  if (!accessToken || accessToken.trim() === '') {\n    return { success: false, message: 'Access Token do Mercado Pago não pode estar vazio.' };\n  }\n\n  try {\n    const currentSettings = await getSettings();\n    const newSettings: SettingsData = {\n      ...currentSettings,\n      mercadoPagoAccessToken: accessToken,\n    };\n    await updateSettings(newSettings);\n    \n    // Revalidate admin settings page if it exists or other relevant paths\n    revalidatePath('/admin/settings');\n    \n    return { success: true, message: 'Configurações do Mercado Pago atualizadas com sucesso.' };\n  } catch (error) {\n    console.error('Error updating Mercado Pago settings:', error);\n    return { success: false, message: 'Ocorreu um erro ao atualizar as configurações do Mercado Pago.' };\n  }\n}\n\nexport async function getMercadoPagoSettingsAction(): Promise<SettingsData> {\n    return getSettings();\n}\n"],"names":[],"mappings":";;;;;;IAMsB;IAuBA","debugId":null}},
    {"offset": {"line": 21, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/app/admin/settings/page.tsx"],"sourcesContent":["\n'use client';\n\nimport { useForm, type SubmitHandler } from 'react-hook-form';\nimport { zodResolver } from '@hookform/resolvers/zod';\nimport * as z from 'zod';\nimport { useToast } from '@/hooks/use-toast';\nimport { useRouter } from 'next/navigation';\nimport { Save, Loader2, ArrowLeft, Settings as SettingsIcon, AlertTriangle } from 'lucide-react';\nimport { useState, useEffect } from 'react';\nimport { useAuth } from '@/contexts/AuthContext';\nimport { updateMercadoPagoSettingsAction, getMercadoPagoSettingsAction } from '@/app/actions/settings-actions';\n\nconst settingsSchema = z.object({\n  mercadoPagoAccessToken: z.string().min(1, { message: 'Access Token do Mercado Pago é obrigatório.' }),\n});\n\ntype SettingsFormValues = z.infer<typeof settingsSchema>;\n\nexport default function AdminSettingsPage() {\n  const { toast } = useToast();\n  const router = useRouter();\n  const { adminUser, isLoading: authIsLoading } = useAuth();\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [isLoadingSettings, setIsLoadingSettings] = useState(true);\n\n  const form = useForm<SettingsFormValues>({\n    resolver: zodResolver(settingsSchema),\n    defaultValues: {\n      mercadoPagoAccessToken: '',\n    },\n  });\n\n  const { register, handleSubmit, formState: { errors }, reset } = form;\n\n  useEffect(() => {\n    if (!authIsLoading && !adminUser) {\n      router.replace('/login?redirect=/admin/dashboard');\n    } else if (adminUser) {\n      async function fetchSettings() {\n        setIsLoadingSettings(true);\n        try {\n          const currentSettings = await getMercadoPagoSettingsAction();\n          if (currentSettings.mercadoPagoAccessToken) {\n            reset({ mercadoPagoAccessToken: currentSettings.mercadoPagoAccessToken });\n          }\n        } catch (error) {\n          console.error(\"Failed to load settings:\", error);\n          toast({\n            title: 'Erro ao Carregar Configurações',\n            description: 'Não foi possível carregar as configurações atuais.',\n            variant: 'destructive',\n          });\n        } finally {\n          setIsLoadingSettings(false);\n        }\n      }\n      fetchSettings();\n    }\n  }, [authIsLoading, adminUser, reset, router, toast]);\n\n  if (authIsLoading || isLoadingSettings) {\n    return (\n      <div className=\"d-flex align-items-center justify-content-center min-vh-100\">\n        <Loader2 className=\"h-12 w-12 animate-spin text-primary\" />\n        <p className=\"ms-2\">Carregando configurações...</p>\n      </div>\n    );\n  }\n\n  if (!adminUser) {\n    return null; \n  }\n\n  const onSubmit: SubmitHandler<SettingsFormValues> = async (data) => {\n    setIsSubmitting(true);\n    const result = await updateMercadoPagoSettingsAction(data.mercadoPagoAccessToken);\n    setIsSubmitting(false);\n\n    if (result.success) {\n      toast({\n        title: 'Configurações Atualizadas!',\n        description: result.message,\n        variant: 'default',\n      });\n    } else {\n      toast({\n        title: 'Falha ao Atualizar',\n        description: result.message,\n        variant: 'destructive',\n      });\n    }\n  };\n\n  return (\n    <div className=\"container-fluid container-md py-4 py-md-5\" style={{maxWidth: '720px'}}>\n      <button onClick={() => router.push('/admin/dashboard')} className=\"btn btn-outline-secondary mb-4 d-flex align-items-center gap-2\">\n        <ArrowLeft className=\"me-2 h-4 w-4\" /> Voltar para o Painel\n      </button>\n      <div className=\"card shadow-xl\">\n        <div className=\"card-header p-3 p-md-4 bg-light\">\n          <h1 className=\"card-title fs-2 fw-bold text-primary d-flex align-items-center gap-2\">\n            <SettingsIcon className=\"h-8 w-8\" /> Configurações da Plataforma\n          </h1>\n          <p className=\"card-text text-muted\">\n            Gerencie as integrações e configurações da plataforma.\n          </p>\n        </div>\n        <div className=\"card-body p-3 p-md-4\">\n          <form onSubmit={handleSubmit(onSubmit)} className=\"needs-validation\" noValidate>\n            <div className=\"card p-3 p-md-4 mb-4 border-primary-subtle\">\n                <h3 className=\"fs-5 fw-semibold text-primary mb-1\">Integração Mercado Pago</h3>\n                <p className=\"small text-muted mb-3\">\n                    Configure o Access Token para processar pagamentos via PIX com o Mercado Pago.\n                </p>\n                <div>\n                    <label htmlFor=\"mercadoPagoAccessToken\" className=\"form-label\">Access Token do Mercado Pago</label>\n                    <input \n                        id=\"mercadoPagoAccessToken\" \n                        type=\"password\"\n                        {...register('mercadoPagoAccessToken')} \n                        className={`form-control ${errors.mercadoPagoAccessToken ? 'is-invalid' : ''}`} \n                        placeholder=\"Cole seu Access Token aqui\"\n                    />\n                    {errors.mercadoPagoAccessToken && <div className=\"invalid-feedback\">{errors.mercadoPagoAccessToken.message}</div>}\n                    <div className=\"form-text small\">\n                        Este token é sensível. Certifique-se de obtê-lo de um ambiente seguro.\n                    </div>\n                </div>\n            </div>\n\n            <button type=\"submit\" className=\"btn btn-primary w-100 btn-lg fw-semibold d-flex align-items-center justify-content-center gap-2\" disabled={isSubmitting}>\n              {isSubmitting ? <Loader2 className=\"me-2 h-4 w-4 animate-spin\" /> : <Save className=\"me-2 h-4 w-4\" />}\n              Salvar Configurações\n            </button>\n          </form>\n        </div>\n      </div>\n       <div className=\"card mt-4 border-danger-subtle bg-danger-subtle\">\n        <div className=\"card-body d-flex align-items-start gap-3 p-3\">\n          <AlertTriangle className=\"h-5 w-5 text-danger mt-1 flex-shrink-0\" />\n          <div>\n            <h4 className=\"fw-semibold text-danger small\">Atenção: Segurança dos Tokens</h4>\n            <p className=\"small text-dark mb-0\">\n              Access Tokens e chaves de API são informações sensíveis. Em um ambiente de produção real,\n              eles devem ser gerenciados através de variáveis de ambiente seguras no servidor ou\n              serviços de gerenciamento de segredos, e não armazenados diretamente em arquivos de configuração\n              versionados ou editáveis por uma interface de usuário desta forma.\n              Esta interface é para fins de demonstração.\n            </p>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}
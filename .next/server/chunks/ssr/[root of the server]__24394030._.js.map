{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 23, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/lib/data-service.ts"],"sourcesContent":["// src/lib/data-service.ts\n'use server';\n\nimport fs from 'fs/promises';\nimport path from 'path';\nimport type { EventData, SaleData, NewSaleDataInternal, UserData, EventCreationData, SettingsData, WithdrawalRequestData } from './types';\nimport { v4 as uuidv4 } from 'uuid'; \n\nconst dataDir = path.join(process.cwd(), 'src', 'data');\nconst eventsFilePath = path.join(dataDir, 'eventos.json');\nconst salesFilePath = path.join(dataDir, 'vendas.json');\nconst usersFilePath = path.join(dataDir, 'usuarios.json');\nconst settingsFilePath = path.join(dataDir, 'settings.json');\nconst withdrawalRequestsFilePath = path.join(dataDir, 'withdrawal-requests.json');\n\n// Helper to read JSON\nasync function readJsonFile<T>(filePath: string, defaultValue?: T): Promise<T> {\n  try {\n    await fs.access(filePath);\n  } catch (error) {\n    if ((error as NodeJS.ErrnoException).code === 'ENOENT') {\n      // If file doesn't exist, create it with default value or empty structure\n      const dataToStore = defaultValue !== undefined ? defaultValue : (filePath.endsWith('s.json') || filePath.endsWith('os.json') ? [] : {});\n      await fs.writeFile(filePath, JSON.stringify(dataToStore, null, 2), 'utf-8');\n      return dataToStore as T;\n    }\n    console.error(`Error accessing file ${filePath}:`, error);\n    throw error; // Re-throw other errors\n  }\n  // File exists, proceed to read and parse\n  try {\n    const jsonData = await fs.readFile(filePath, 'utf-8');\n    return JSON.parse(jsonData) as T;\n  } catch (error) {\n    console.error(`Error reading or parsing JSON from ${filePath}:`, error);\n    // Fallback to default value if provided on read/parse error\n    if (defaultValue !== undefined) return defaultValue;\n    // Specific fallback for list-like files if no default is provided\n    if (filePath.endsWith('s.json') || filePath.endsWith('os.json')) { \n      return [] as T; // Treat as empty list on error if it's a list file\n    }\n    throw error; // Re-throw other errors\n  }\n}\n\n// Helper to write JSON\nasync function writeJsonFile<T>(filePath: string, data: T): Promise<void> {\n  try {\n    const jsonData = JSON.stringify(data, null, 2);\n    await fs.writeFile(filePath, jsonData, 'utf-8');\n  } catch (error) {\n    console.error(`Error writing JSON to ${filePath}:`, error);\n    throw error;\n  }\n}\n\n// Settings functions\nexport async function getSettings(): Promise<SettingsData> {\n  return readJsonFile<SettingsData>(settingsFilePath, { mercadoPagoAccessToken: '' });\n}\n\nexport async function updateSettings(newSettings: Partial<SettingsData>): Promise<SettingsData> {\n  const currentSettings = await getSettings();\n  const updatedSettings = { ...currentSettings, ...newSettings };\n  await writeJsonFile(settingsFilePath, updatedSettings);\n  return updatedSettings;\n}\n\n\n// Event functions\nexport async function getEvents(): Promise<EventData[]> {\n  return readJsonFile<EventData[]>(eventsFilePath, []);\n}\n\nexport async function getEventById(id: string): Promise<EventData | undefined> {\n  const events = await getEvents();\n  return events.find(event => event.id === id);\n}\n\nexport async function getEventsByOrganizerId(organizerId: string): Promise<EventData[]> {\n  const events = await getEvents();\n  return events.filter(event => event.organizer_id === organizerId);\n}\n\nexport async function addEvent(eventDetails: EventCreationData, organizerId: string): Promise<EventData> {\n  const events = await getEvents();\n  \n  const newEvent: EventData = {\n    id: `evt-${uuidv4()}`,\n    organizer_id: organizerId,\n    ...eventDetails, \n    quantidade_disponivel: eventDetails.quantidade_total,\n    imagem_url: eventDetails.imagem_url || undefined,\n    next_sale_reference_number: 1, // Initialize counter\n  };\n  events.push(newEvent);\n  await writeJsonFile(eventsFilePath, events);\n  return newEvent;\n}\n\nexport async function updateEventSaleReferenceCounter(eventId: string, newCounterValue: number): Promise<boolean> {\n    const events = await getEvents();\n    const eventIndex = events.findIndex(event => event.id === eventId);\n\n    if (eventIndex === -1) {\n        console.error(`Event with ID ${eventId} not found for counter update.`);\n        return false;\n    }\n    events[eventIndex].next_sale_reference_number = newCounterValue;\n    await writeJsonFile(eventsFilePath, events);\n    console.log(`Event ${eventId} sale reference counter updated to ${newCounterValue}`);\n    return true;\n}\n\n\nexport async function updateEvent(eventId: string, updates: EventCreationData, currentOrganizerId: string): Promise<EventData | null> {\n  const events = await getEvents();\n  const eventIndex = events.findIndex(event => event.id === eventId);\n\n  if (eventIndex === -1) {\n    console.error(`Event with ID ${eventId} not found for update.`);\n    return null; \n  }\n\n  const currentEvent = events[eventIndex];\n\n  if (currentEvent.organizer_id !== currentOrganizerId) {\n    console.error(`Organizer ${currentOrganizerId} does not have permission to update event ${eventId}.`);\n    return null; \n  }\n\n  const ticketsSold = currentEvent.quantidade_total - currentEvent.quantidade_disponivel;\n\n  if (updates.quantidade_total < ticketsSold) {\n    console.error(`Cannot update event ${eventId}: new total quantity (${updates.quantidade_total}) is less than tickets already sold (${ticketsSold}).`);\n    return null; \n  }\n  \n  const newQuantidadeDisponivel = updates.quantidade_total - ticketsSold;\n\n  const updatedEvent: EventData = {\n    ...currentEvent, \n    ...updates,\n    quantidade_disponivel: newQuantidadeDisponivel,\n    imagem_url: updates.imagem_url || currentEvent.imagem_url, // Preserve existing image if not updated\n    next_sale_reference_number: currentEvent.next_sale_reference_number || 1, // Preserve counter or initialize\n  };\n\n  events[eventIndex] = updatedEvent;\n  await writeJsonFile(eventsFilePath, events);\n  return updatedEvent;\n}\n\n\nexport async function deleteEventAndSalesById(eventId: string): Promise<{success: boolean; message?: string}> {\n  try {\n    let events = await getEvents();\n    const eventExists = events.some(event => event.id === eventId);\n    if (!eventExists) {\n      return { success: false, message: 'Evento nÃ£o encontrado.' };\n    }\n    events = events.filter(event => event.id !== eventId);\n    await writeJsonFile(eventsFilePath, events);\n\n    let sales = await getAllSales();\n    sales = sales.filter(sale => sale.evento_id !== eventId);\n    await writeJsonFile(salesFilePath, sales);\n    \n    return { success: true };\n  } catch (error) {\n    console.error('Error deleting event and associated sales:', error);\n    return { success: false, message: 'Erro ao excluir evento e vendas associadas.' };\n  }\n}\n\n\n// Sale functions\nexport async function getAllSales(): Promise<SaleData[]> {\n  return readJsonFile<SaleData[]>(salesFilePath, []);\n}\n\nexport async function getSaleById(id: string): Promise<SaleData | undefined> {\n  const sales = await getAllSales();\n  return sales.find(sale => sale.id === id);\n}\n\nexport async function getSaleByMercadoPagoExternalReference(mpExternalRef: string): Promise<SaleData | undefined> {\n  const sales = await getAllSales();\n  return sales.find(sale => sale.mercado_pago_external_reference === mpExternalRef);\n}\n\n\nexport async function addSale(saleData: NewSaleDataInternal): Promise<SaleData> {\n  const sales = await getAllSales();\n  const newSale: SaleData = {\n    id: `sale-${uuidv4().substring(0, 12)}`, // Shortened internal TrinkaPass Sale ID\n    ...saleData,\n    // mercado_pago_external_reference is already part of saleData from initiatePurchaseAction\n  };\n  sales.push(newSale);\n  await writeJsonFile(salesFilePath, sales);\n  return newSale;\n}\n\nexport async function updateSale(saleId: string, updates: Partial<Omit<SaleData, 'id' | 'evento_id' | 'nome_comprador' | 'email_comprador' | 'whatsapp' | 'quantidade' | 'preco_ingresso_unitario' | 'taxa_servico_unitaria' | 'valor_total_item' | 'valor_total_compra' | 'data_compra' | 'pix_copia_cola_mp' | 'mercado_pago_external_reference' >>): Promise<SaleData | null> {\n  const sales = await getAllSales();\n  const saleIndex = sales.findIndex(s => s.id === saleId);\n  if (saleIndex === -1) {\n    console.error(`Sale with ID ${saleId} not found for update.`);\n    return null;\n  }\n  sales[saleIndex] = { ...sales[saleIndex], ...updates };\n  await writeJsonFile(salesFilePath, sales);\n  return sales[saleIndex];\n}\n\n\nexport async function getSalesByEventId(eventId: string): Promise<SaleData[]> {\n  const sales = await getAllSales();\n  return sales.filter(sale => sale.evento_id === eventId);\n}\n\n\nexport async function updateEventStock(eventId: string, quantityChange: number, newAvailableQuantity?: number): Promise<boolean> {\n  const events = await getEvents(); \n  const eventIndex = events.findIndex(event => event.id === eventId);\n  if (eventIndex === -1) {\n    console.error(`Event with ID ${eventId} not found for stock update.`);\n    return false;\n  }\n\n  const currentEvent = events[eventIndex];\n\n  if (newAvailableQuantity !== undefined) {\n    if (newAvailableQuantity < 0 || newAvailableQuantity > currentEvent.quantidade_total) {\n      console.warn(`Invalid newAvailableQuantity ${newAvailableQuantity} for event ${eventId}. Max total: ${currentEvent.quantidade_total}.`);\n      return false;\n    }\n    currentEvent.quantidade_disponivel = newAvailableQuantity;\n  } else {\n    const proposedAvailable = currentEvent.quantidade_disponivel - quantityChange;\n    if (proposedAvailable < 0) {\n      console.warn(`Not enough stock for event ID ${eventId}. Available: ${currentEvent.quantidade_disponivel}, Requested change: ${quantityChange}`);\n      return false;\n    }\n    if (proposedAvailable > currentEvent.quantidade_total) {\n      console.warn(`Proposed available stock ${proposedAvailable} exceeds total quantity ${currentEvent.quantidade_total} for event ${eventId}. Capping at total.`);\n      currentEvent.quantidade_disponivel = currentEvent.quantidade_total;\n    } else {\n      currentEvent.quantidade_disponivel = proposedAvailable;\n    }\n  }\n  \n  events[eventIndex] = currentEvent;\n  await writeJsonFile(eventsFilePath, events);\n  console.log(`Stock for event ${eventId} updated. New available: ${currentEvent.quantidade_disponivel}`);\n  return true;\n}\n\n\n// User functions\nexport async function getUsers(): Promise<UserData[]> {\n return readJsonFile<UserData[]>(usersFilePath, []);\n}\n\nexport async function getUserById(id: string): Promise<UserData | undefined> {\n  const users = await getUsers();\n  return users.find(user => user.id === id);\n}\n\nexport async function getUserByEmail(email: string): Promise<UserData | undefined> {\n  const users = await getUsers();\n  return users.find(user => user.email === email);\n}\n\nexport async function addUser(userData: UserData): Promise<UserData> {\n  const users = await getUsers();\n  users.push(userData);\n  await writeJsonFile(usersFilePath, users);\n  return userData;\n}\n\nexport async function updateUser(userId: string, updates: Partial<Omit<UserData, 'id' | 'tipo'>>): Promise<UserData | null> {\n  const users = await getUsers();\n  const userIndex = users.findIndex(user => user.id === userId);\n\n  if (userIndex === -1) {\n    console.error(`User with ID ${userId} not found for update.`);\n    return null;\n  }\n\n  const updatedUser: UserData = { ...users[userIndex] };\n\n  if (updates.nome !== undefined) updatedUser.nome = updates.nome;\n  if (updates.email !== undefined) updatedUser.email = updates.email;\n  if (updates.whatsapp !== undefined) updatedUser.whatsapp = updates.whatsapp;\n  if (updates.password_hash !== undefined) updatedUser.password_hash = updates.password_hash;\n  \n  if (updates.pix_key_type !== undefined) {\n    updatedUser.pix_key_type = updates.pix_key_type === '' ? undefined : updates.pix_key_type;\n  }\n  if (updates.pix_key !== undefined) {\n     updatedUser.pix_key = updates.pix_key === '' ? undefined : updates.pix_key;\n  }\n  if (updates.id_photo_data_uri !== undefined) {\n    updatedUser.id_photo_data_uri = updates.id_photo_data_uri === '' ? undefined : updates.id_photo_data_uri;\n  }\n  // Update is_verified status if provided\n  if (updates.is_verified !== undefined) {\n    updatedUser.is_verified = updates.is_verified;\n  }\n\n\n  users[userIndex] = updatedUser;\n  await writeJsonFile(usersFilePath, users);\n  return updatedUser;\n}\n\nexport async function deleteUserById(userId: string): Promise<{success: boolean; message?: string}> {\n  try {\n    let users = await getUsers();\n    const userExists = users.some(user => user.id === userId);\n    if (!userExists) {\n      return { success: false, message: 'UsuÃ¡rio nÃ£o encontrado.' };\n    }\n    users = users.filter(user => user.id !== userId);\n    await writeJsonFile(usersFilePath, users);\n    return { success: true };\n  } catch (error) {\n    console.error('Error deleting user:', error);\n    return { success: false, message: 'Erro ao excluir usuÃ¡rio.' };\n  }\n}\n\n// Withdrawal Request Functions\nexport async function getWithdrawalRequests(): Promise<WithdrawalRequestData[]> {\n  return readJsonFile<WithdrawalRequestData[]>(withdrawalRequestsFilePath, []);\n}\n\nexport async function addWithdrawalRequest(requestData: Omit<WithdrawalRequestData, 'id' | 'requestDate' | 'status'>): Promise<WithdrawalRequestData> {\n  const requests = await getWithdrawalRequests();\n  const newRequest: WithdrawalRequestData = {\n    id: `wdrl-${uuidv4()}`,\n    ...requestData,\n    requestDate: new Date().toISOString(),\n    status: 'pending',\n  };\n  requests.push(newRequest);\n  await writeJsonFile(withdrawalRequestsFilePath, requests);\n  return newRequest;\n}\n\nexport async function updateWithdrawalRequestStatus(\n  requestId: string,\n  status: 'approved' | 'rejected',\n  adminNotes?: string\n): Promise<WithdrawalRequestData | null> {\n  const requests = await getWithdrawalRequests();\n  const requestIndex = requests.findIndex(req => req.id === requestId);\n\n  if (requestIndex === -1) {\n    console.error(`Withdrawal request with ID ${requestId} not found.`);\n    return null;\n  }\n\n  if (requests[requestIndex].status !== 'pending') {\n     console.warn(`Withdrawal request ${requestId} is already processed. Current status: ${requests[requestIndex].status}`);\n     return requests[requestIndex]; // Or return null if re-processing is not allowed\n  }\n\n  requests[requestIndex].status = status;\n  requests[requestIndex].processedDate = new Date().toISOString();\n  if (adminNotes) {\n    requests[requestIndex].adminNotes = adminNotes;\n  }\n\n  await writeJsonFile(withdrawalRequestsFilePath, requests);\n  return requests[requestIndex];\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 448, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/app/actions/event-actions.ts"],"sourcesContent":["// src/app/actions/event-actions.ts\n'use server';\n\nimport { addEvent, getEventById, updateEvent } from '@/lib/data-service';\nimport type { EventCreationData, EventData } from '@/lib/types';\nimport { revalidatePath } from 'next/cache';\n\ninterface CreateEventResult {\n  success: boolean;\n  event?: EventData;\n  error?: string;\n  fieldErrors?: Record<string, string>;\n}\n\ninterface UpdateEventResult extends CreateEventResult {}\n\n\nexport async function createEventAction(\n  eventDetails: EventCreationData,\n  organizerId: string\n): Promise<CreateEventResult> {\n  // Basic server-side validation (Zod schema validation should also happen on client)\n  if (!eventDetails.nome_evento || eventDetails.nome_evento.length < 3) {\n    return { success: false, error: 'Nome do evento Ã© obrigatÃ³rio e deve ter pelo menos 3 caracteres.', fieldErrors: { nome_evento: 'Nome do evento Ã© obrigatÃ³rio.'} };\n  }\n  if (!eventDetails.descricao || eventDetails.descricao.length < 10) {\n    return { success: false, error: 'DescriÃ§Ã£o Ã© obrigatÃ³ria e deve ter pelo menos 10 caracteres.', fieldErrors: { descricao: 'DescriÃ§Ã£o Ã© obrigatÃ³ria.'} };\n  }\n  if (!eventDetails.data_horario) {\n    return { success: false, error: 'Data e horÃ¡rio sÃ£o obrigatÃ³rios.', fieldErrors: { data_horario_date: 'Data Ã© obrigatÃ³ria.', data_horario_time: 'HorÃ¡rio Ã© obrigatÃ³rio.'} };\n  }\n  // Check if date is in the past - simple check\n  if (new Date(eventDetails.data_horario) < new Date()) {\n      return { success: false, error: 'A data do evento nÃ£o pode ser no passado.', fieldErrors: { data_horario_date: 'Data nÃ£o pode ser no passado.'} };\n  }\n  if (eventDetails.nome_local_evento && eventDetails.nome_local_evento.length < 3) {\n    return { success: false, error: 'Nome do local do evento deve ter pelo menos 3 caracteres.', fieldErrors: { nome_local_evento: 'Nome do local do evento invÃ¡lido.' } };\n  }\n  if (!eventDetails.cep || !/^\\d{5}-?\\d{3}$/.test(eventDetails.cep)) {\n    return { success: false, error: 'CEP Ã© obrigatÃ³rio e deve estar no formato correto.', fieldErrors: { cep: 'CEP invÃ¡lido.' } };\n  }\n  if (!eventDetails.local || eventDetails.local.length < 5) {\n    return { success: false, error: 'EndereÃ§o (Rua, Bairro, NÃºmero) Ã© obrigatÃ³rio e deve ter pelo menos 5 caracteres.', fieldErrors: { local: 'EndereÃ§o Ã© obrigatÃ³rio.'} };\n  }\n  if (!eventDetails.cidade || eventDetails.cidade.length < 3) {\n    return { success: false, error: 'Cidade Ã© obrigatÃ³ria e deve ter pelo menos 3 caracteres.', fieldErrors: { cidade: 'Cidade Ã© obrigatÃ³ria.'} };\n  }\n  if (eventDetails.preco_ingresso === undefined || eventDetails.preco_ingresso < 0) {\n    return { success: false, error: 'PreÃ§o do ingresso deve ser um valor positivo ou zero.', fieldErrors: { preco_ingresso: 'PreÃ§o invÃ¡lido.'} };\n  }\n  if (eventDetails.quantidade_total === undefined || eventDetails.quantidade_total <= 0) {\n    return { success: false, error: 'Quantidade total de ingressos deve ser maior que zero.', fieldErrors: { quantidade_total: 'Quantidade invÃ¡lida.'} };\n  }\n\n  if (!organizerId) {\n      return { success: false, error: 'ID do organizador nÃ£o fornecido. FaÃ§a login novamente.' };\n  }\n  if (eventDetails.imagem_url && !eventDetails.imagem_url.startsWith('data:image/')) {\n    return { success: false, error: 'Formato de imagem invÃ¡lido. Use o upload.', fieldErrors: { imagem_url: 'Imagem invÃ¡lida.' } };\n  }\n\n\n  try {\n    const newEvent = await addEvent(eventDetails, organizerId);\n    \n    revalidatePath('/'); \n    revalidatePath('/organizer/dashboard'); \n    \n    return { success: true, event: newEvent };\n\n  } catch (error) {\n    console.error('Error creating event:', error);\n    let errorMessage = 'Ocorreu um erro ao criar o evento.';\n    if (error instanceof Error) {\n      errorMessage = error.message;\n    }\n    return { success: false, error: errorMessage };\n  }\n}\n\nexport async function updateEventAction(\n  eventId: string,\n  eventDetails: EventCreationData,\n  organizerId: string\n): Promise<UpdateEventResult> {\n  // Basic server-side validation\n  if (!eventDetails.nome_evento || eventDetails.nome_evento.length < 3) {\n    return { success: false, error: 'Nome do evento Ã© obrigatÃ³rio e deve ter pelo menos 3 caracteres.', fieldErrors: { nome_evento: 'Nome do evento Ã© obrigatÃ³rio.'} };\n  }\n  if (!eventDetails.descricao || eventDetails.descricao.length < 10) {\n    return { success: false, error: 'DescriÃ§Ã£o Ã© obrigatÃ³ria e deve ter pelo menos 10 caracteres.', fieldErrors: { descricao: 'DescriÃ§Ã£o Ã© obrigatÃ³ria.'} };\n  }\n  if (!eventDetails.data_horario) {\n    return { success: false, error: 'Data e horÃ¡rio sÃ£o obrigatÃ³rios.', fieldErrors: { data_horario_date: 'Data Ã© obrigatÃ³ria.', data_horario_time: 'HorÃ¡rio Ã© obrigatÃ³rio.'} };\n  }\n  if (new Date(eventDetails.data_horario).toString() === \"Invalid Date\") {\n      return { success: false, error: 'Data do evento invÃ¡lida.', fieldErrors: { data_horario_date: 'Data invÃ¡lida.'} };\n  }\n   if (eventDetails.nome_local_evento && eventDetails.nome_local_evento.length < 3) {\n    return { success: false, error: 'Nome do local do evento deve ter pelo menos 3 caracteres.', fieldErrors: { nome_local_evento: 'Nome do local do evento invÃ¡lido.' } };\n  }\n  if (!eventDetails.cep || !/^\\d{5}-?\\d{3}$/.test(eventDetails.cep)) {\n    return { success: false, error: 'CEP Ã© obrigatÃ³rio e deve estar no formato correto.', fieldErrors: { cep: 'CEP invÃ¡lido.' } };\n  }\n  if (!eventDetails.local || eventDetails.local.length < 5) {\n    return { success: false, error: 'EndereÃ§o (Rua, Bairro, NÃºmero) Ã© obrigatÃ³rio e deve ter pelo menos 5 caracteres.', fieldErrors: { local: 'EndereÃ§o Ã© obrigatÃ³rio.'} };\n  }\n  if (!eventDetails.cidade || eventDetails.cidade.length < 3) {\n    return { success: false, error: 'Cidade Ã© obrigatÃ³ria e deve ter pelo menos 3 caracteres.', fieldErrors: { cidade: 'Cidade Ã© obrigatÃ³ria.'} };\n  }\n  if (eventDetails.preco_ingresso === undefined || eventDetails.preco_ingresso < 0) {\n    return { success: false, error: 'PreÃ§o do ingresso deve ser um valor positivo ou zero.', fieldErrors: { preco_ingresso: 'PreÃ§o invÃ¡lido.'} };\n  }\n  if (eventDetails.quantidade_total === undefined || eventDetails.quantidade_total <= 0) {\n    return { success: false, error: 'Quantidade total de ingressos deve ser maior que zero.', fieldErrors: { quantidade_total: 'Quantidade invÃ¡lida.'} };\n  }\n\n  if (!organizerId) {\n      return { success: false, error: 'ID do organizador nÃ£o fornecido. FaÃ§a login novamente.' };\n  }\n  if (!eventId) {\n      return { success: false, error: 'ID do evento nÃ£o fornecido para atualizaÃ§Ã£o.' };\n  }\n  if (eventDetails.imagem_url && !eventDetails.imagem_url.startsWith('data:image/')) {\n    return { success: false, error: 'Formato de imagem invÃ¡lido. Use o upload.', fieldErrors: { imagem_url: 'Imagem invÃ¡lida.' } };\n  }\n\n  try {\n    const existingEvent = await getEventById(eventId);\n    if (!existingEvent) {\n      return { success: false, error: 'Evento nÃ£o encontrado para atualizaÃ§Ã£o.' };\n    }\n    if (existingEvent.organizer_id !== organizerId) {\n      return { success: false, error: 'VocÃª nÃ£o tem permissÃ£o para editar este evento.' };\n    }\n\n    const ticketsSold = existingEvent.quantidade_total - existingEvent.quantidade_disponivel;\n    if (eventDetails.quantidade_total < ticketsSold) {\n      return { \n        success: false, \n        error: `A nova quantidade total de ingressos (${eventDetails.quantidade_total}) nÃ£o pode ser menor que a quantidade jÃ¡ vendida (${ticketsSold}).`,\n        fieldErrors: { quantidade_total: 'Quantidade total invÃ¡lida devido aos ingressos jÃ¡ vendidos.'}\n      };\n    }\n\n    const updatedEvent = await updateEvent(eventId, eventDetails, organizerId);\n    \n    if (!updatedEvent) {\n        return { success: false, error: 'Falha ao atualizar o evento no serviÃ§o de dados.' };\n    }\n    \n    revalidatePath('/'); \n    revalidatePath('/organizer/dashboard'); \n    revalidatePath(`/event/${eventId}`); \n    revalidatePath(`/organizer/events/${eventId}/edit`); \n    \n    return { success: true, event: updatedEvent };\n\n  } catch (error) {\n    console.error('Error updating event:', error);\n    let errorMessage = 'Ocorreu um erro ao atualizar o evento.';\n    if (error instanceof Error) {\n      errorMessage = error.message;\n    }\n    return { success: false, error: errorMessage };\n  }\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 769, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/app/actions/cep-actions.ts"],"sourcesContent":["'use server';\n\nimport type { ViaCepResponse, CepActionResult } from '@/lib/types';\n\nexport async function fetchAddressByCepAction(cep: string): Promise<CepActionResult> {\n  const cleanedCep = cep.replace(/\\D/g, ''); // Remove non-digits\n\n  if (cleanedCep.length !== 8) {\n    return { success: false, error: 'CEP invÃ¡lido. Deve conter 8 dÃ­gitos.' };\n  }\n\n  try {\n    const response = await fetch(`https://viacep.com.br/ws/${cleanedCep}/json/`);\n    if (!response.ok) {\n      // ViaCEP might return non-200 for errors like too many requests, though usually it's 200 with \"erro: true\"\n      console.error(`ViaCEP API request failed with status ${response.status} for CEP ${cleanedCep}`);\n      return { success: false, error: `Falha ao buscar CEP. Status: ${response.status}` };\n    }\n\n    const data: ViaCepResponse = await response.json();\n\n    if (data.erro) {\n      return { success: false, error: 'CEP nÃ£o encontrado.' };\n    }\n\n    return { success: true, data };\n  } catch (error) {\n    console.error('Error fetching CEP data:', error);\n    return { success: false, error: 'Ocorreu um erro ao buscar o CEP. Verifique sua conexÃ£o.' };\n  }\n}\n"],"names":[],"mappings":";;;;;;;;AAIO,eAAe,uCAAqB,GAArB,wBAAwB,GAAW;IACvD,MAAM,aAAa,IAAI,OAAO,CAAC,OAAO,KAAK,oBAAoB;IAE/D,IAAI,WAAW,MAAM,KAAK,GAAG;QAC3B,OAAO;YAAE,SAAS;YAAO,OAAO;QAAuC;IACzE;IAEA,IAAI;QACF,MAAM,WAAW,MAAM,MAAM,CAAC,yBAAyB,EAAE,WAAW,MAAM,CAAC;QAC3E,IAAI,CAAC,SAAS,EAAE,EAAE;YAChB,2GAA2G;YAC3G,QAAQ,KAAK,CAAC,CAAC,sCAAsC,EAAE,SAAS,MAAM,CAAC,SAAS,EAAE,YAAY;YAC9F,OAAO;gBAAE,SAAS;gBAAO,OAAO,CAAC,6BAA6B,EAAE,SAAS,MAAM,EAAE;YAAC;QACpF;QAEA,MAAM,OAAuB,MAAM,SAAS,IAAI;QAEhD,IAAI,KAAK,IAAI,EAAE;YACb,OAAO;gBAAE,SAAS;gBAAO,OAAO;YAAsB;QACxD;QAEA,OAAO;YAAE,SAAS;YAAM;QAAK;IAC/B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,4BAA4B;QAC1C,OAAO;YAAE,SAAS;YAAO,OAAO;QAA0D;IAC5F;AACF;;;IA1BsB;;AAAA,+OAAA","debugId":null}},
    {"offset": {"line": 825, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 890, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/app/organizer/events/create/page.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/app/organizer/events/create/page.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/app/organizer/events/create/page.tsx <module evaluation>\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;AAAA;;uCACe,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACjC;IAAa,MAAM,IAAI,MAAM;AAA4S,GACzU,0EACA","debugId":null}},
    {"offset": {"line": 904, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/app/organizer/events/create/page.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/app/organizer/events/create/page.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/app/organizer/events/create/page.tsx\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;AAAA;;uCACe,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACjC;IAAa,MAAM,IAAI,MAAM;AAAwR,GACrT,sDACA","debugId":null}},
    {"offset": {"line": 918, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}}]
}
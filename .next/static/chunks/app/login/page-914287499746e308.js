(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[520],{283:(e,t,a)=>{"use strict";a.d(t,{A:()=>l,AuthProvider:()=>i});var r=a(5155),s=a(5695),o=a(2115);let n=(0,o.createContext)(void 0);function i(e){let{children:t}=e,[a,i]=(0,o.useState)(!1),[l,d]=(0,o.useState)(null),[c,u]=(0,o.useState)(!1),[m,g]=(0,o.useState)(null),[p,f]=(0,o.useState)(!0),h=(0,s.useRouter)(),v=(0,s.usePathname)();(0,o.useEffect)(()=>{f(!0);try{let e=localStorage.getItem("isAdminLoggedIn"),t=localStorage.getItem("adminUser");if("true"===e&&t){let e=JSON.parse(t);"admin"===e.tipo?(i(!0),d(e)):(localStorage.removeItem("isAdminLoggedIn"),localStorage.removeItem("adminUser"))}let a=localStorage.getItem("isOrganizerLoggedIn"),r=localStorage.getItem("organizerUser");if("true"===a&&r){let e=JSON.parse(r);"organizer"===e.tipo?(u(!0),g(e)):(localStorage.removeItem("isOrganizerLoggedIn"),localStorage.removeItem("organizerUser"))}}catch(e){console.error("Failed to access localStorage or parse auth data:",e),localStorage.removeItem("isAdminLoggedIn"),localStorage.removeItem("adminUser"),localStorage.removeItem("isOrganizerLoggedIn"),localStorage.removeItem("organizerUser")}f(!1)},[]);let S=function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];try{localStorage.removeItem("isAdminLoggedIn"),localStorage.removeItem("adminUser")}catch(e){console.error("Failed to remove admin auth data from localStorage:",e)}i(!1),d(null),e&&v.startsWith("/admin")&&h.push("/login")},x=function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];try{localStorage.removeItem("isOrganizerLoggedIn"),localStorage.removeItem("organizerUser")}catch(e){console.error("Failed to remove organizer auth data from localStorage:",e)}u(!1),g(null),e&&v.startsWith("/organizer")&&h.push("/login")};return(0,r.jsx)(n.Provider,{value:{isAdminLoggedIn:a,adminUser:l,setIsAdminLoggedIn:i,setAdminUser:d,adminLogin:e=>{if("admin"!==e.tipo){console.error("Attempted to log in non-admin user as admin.");return}try{localStorage.setItem("isAdminLoggedIn","true"),localStorage.setItem("adminUser",JSON.stringify(e))}catch(e){console.error("Failed to set admin auth data in localStorage:",e)}i(!0),d(e),x(!1)},adminLogout:S,isOrganizerLoggedIn:c,organizerUser:m,setIsOrganizerLoggedIn:u,setOrganizerUser:g,organizerLogin:e=>{if("organizer"!==e.tipo){console.error("Attempted to log in non-organizer user as organizer.");return}try{localStorage.setItem("isOrganizerLoggedIn","true"),localStorage.setItem("organizerUser",JSON.stringify(e))}catch(e){console.error("Failed to set organizer auth data in localStorage:",e)}u(!0),g(e),S(!1)},organizerLogout:x,isLoading:p},children:t})}function l(){let e=(0,o.useContext)(n);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},2371:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>x});var r=a(5155),s=a(2177),o=a(221),n=a(5594),i=a(7481),l=a(4477);let d=(0,l.createServerReference)("40b0c62d7c79d53b3b72709cf8b487a2a988cf8785",l.callServer,void 0,l.findSourceMapURL,"unifiedLoginAction");var c=a(283),u=a(6874),m=a.n(u),g=a(5695),p=a(172),f=a(7104),h=a(3896),v=a(2115);let S=n.Ik({email:n.Yj().email({message:"E-mail inv\xe1lido."}),password:n.Yj().min(1,{message:"Senha \xe9 obrigat\xf3ria."})});function x(){let{toast:e}=(0,i.dj)(),{adminLogin:t,organizerLogin:a,isAdminLoggedIn:n,isOrganizerLoggedIn:l,isLoading:u}=(0,c.A)(),x=(0,g.useRouter)(),[y,b]=(0,v.useState)(!1),{register:j,handleSubmit:I,formState:{errors:A}}=(0,s.mN)({resolver:(0,o.u)(S),defaultValues:{email:"",password:""}});if((0,v.useEffect)(()=>{!u&&(n?x.replace("/admin/dashboard"):l&&x.replace("/organizer/dashboard"))},[u,n,l,x]),u)return(0,r.jsxs)("div",{className:"d-flex align-items-center justify-content-center min-vh-100",style:{marginTop:"-56px"},children:[" ",(0,r.jsx)(p.A,{className:"h-12 w-12 animate-spin text-primary"})]});if(n||l)return(0,r.jsxs)("div",{className:"d-flex align-items-center justify-content-center min-vh-100",style:{marginTop:"-56px"},children:[(0,r.jsx)(p.A,{className:"h-12 w-12 animate-spin text-primary"}),(0,r.jsx)("p",{className:"ms-2",children:"Redirecionando..."})]});let N=async r=>{b(!0);let s=await d(r);b(!1),s.success&&s.user&&s.userType?"admin"===s.userType&&s.user?(t(s.user),e({title:"Login de Admin Bem-Sucedido!",description:"Bem-vindo, ".concat(s.user.nome,"!")}),x.push("/admin/dashboard")):"organizer"===s.userType&&s.user?(a(s.user),e({title:"Login de Organizador Bem-Sucedido!",description:"Bem-vindo, ".concat(s.user.nome,"!")}),x.push("/organizer/dashboard")):e({title:"Falha no Login",description:"Tipo de usu\xe1rio desconhecido ou dados de usu\xe1rio ausentes.",variant:"destructive"}):e({title:"Falha no Login",description:s.message,variant:"destructive"})};return(0,r.jsxs)("div",{className:"d-flex align-items-center justify-content-center min-vh-100 py-5",style:{marginTop:"-56px"},children:[" ",(0,r.jsxs)("div",{className:"card border",style:{width:"100%",maxWidth:"450px"},children:[" ",(0,r.jsxs)("div",{className:"card-header p-4 text-center",children:[(0,r.jsxs)("h1",{className:"card-title fs-2 fw-bold text-primary d-flex align-items-center justify-content-center gap-2",children:[(0,r.jsx)(f.A,{className:"h-8 w-8"})," Acesso ao Sistema"]}),(0,r.jsx)("p",{className:"card-text text-muted",children:"Fa\xe7a login para gerenciar eventos ou acessar o painel administrativo."})]}),(0,r.jsxs)("div",{className:"card-body p-4 p-md-5",children:[(0,r.jsxs)("form",{onSubmit:I(N),className:"needs-validation",noValidate:!0,children:[(0,r.jsxs)("div",{className:"mb-3",children:[(0,r.jsx)("label",{htmlFor:"email",className:"form-label",children:"E-mail"}),(0,r.jsx)("input",{id:"email",type:"email",...j("email"),className:"form-control ".concat(A.email?"is-invalid":""),autoComplete:"email"}),A.email&&(0,r.jsx)("div",{className:"invalid-feedback",children:A.email.message})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{htmlFor:"password",className:"form-label",children:"Senha"}),(0,r.jsx)("input",{id:"password",type:"password",...j("password"),className:"form-control ".concat(A.password?"is-invalid":""),autoComplete:"current-password"}),A.password&&(0,r.jsx)("div",{className:"invalid-feedback",children:A.password.message})]}),(0,r.jsxs)("button",{type:"submit",className:"btn btn-primary w-100 btn-lg fw-semibold",disabled:y,children:[y?(0,r.jsx)(p.A,{className:"me-2 h-4 w-4 animate-spin"}):(0,r.jsx)(f.A,{className:"me-2 h-4 w-4"}),"Entrar"]})]}),(0,r.jsx)("div",{className:"mt-4 text-center",children:(0,r.jsxs)("p",{className:"text-muted small",children:["N\xe3o tem uma conta de organizador?"," ",(0,r.jsxs)(m(),{href:"/organizer/register",className:"btn btn-secondary btn-sm text-decoration-none",children:[(0,r.jsx)(h.A,{className:"me-1 h-4 w-4"})," Cadastre-se"]})]})})]})]})]})}},3896:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(157).A)("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]])},4932:(e,t,a)=>{Promise.resolve().then(a.bind(a,2371))},5695:(e,t,a)=>{"use strict";var r=a(8999);a.o(r,"useParams")&&a.d(t,{useParams:function(){return r.useParams}}),a.o(r,"usePathname")&&a.d(t,{usePathname:function(){return r.usePathname}}),a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}})},6654:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"useMergedRef",{enumerable:!0,get:function(){return s}});let r=a(2115);function s(e,t){let a=(0,r.useRef)(null),s=(0,r.useRef)(null);return(0,r.useCallback)(r=>{if(null===r){let e=a.current;e&&(a.current=null,e());let t=s.current;t&&(s.current=null,t())}else e&&(a.current=o(e,r)),t&&(s.current=o(t,r))},[e,t])}function o(e,t){if("function"!=typeof e)return e.current=t,()=>{e.current=null};{let a=e(t);return"function"==typeof a?a:()=>e(null)}}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},7104:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(157).A)("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]])},7481:(e,t,a)=>{"use strict";a.d(t,{dj:()=>m});var r=a(2115);let s=0,o=new Map,n=e=>{if(o.has(e))return;let t=setTimeout(()=>{o.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);o.set(e,t)},i=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:a}=t;return a?n(a):e.toasts.forEach(e=>{n(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===a||void 0===a?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},l=[],d={toasts:[]};function c(e){d=i(d,e),l.forEach(e=>{e(d)})}function u(e){let{...t}=e,a=(s=(s+1)%Number.MAX_SAFE_INTEGER).toString(),r=()=>c({type:"DISMISS_TOAST",toastId:a});return c({type:"ADD_TOAST",toast:{...t,id:a,open:!0,onOpenChange:e=>{e||r()}}}),{id:a,dismiss:r,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:a}})}}function m(){let[e,t]=r.useState(d);return r.useEffect(()=>(l.push(t),()=>{let e=l.indexOf(t);e>-1&&l.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}}},e=>{var t=t=>e(e.s=t);e.O(0,[521,874,441,684,358],()=>t(4932)),_N_E=e.O()}]);